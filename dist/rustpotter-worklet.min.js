var s,e;!function(s){s.STARTED="started",s.STOPPED="stop",s.AUDIO="audio"}(s||(s={})),function(s){s.START="start",s.STOP="stop",s.PROCESS="process"}(e||(e={}));class t{constructor(s,e){this.samplesPerFrame=s,this.sendMsg=e,this.samplesOffset=0,this.samples=new Float32Array(this.samplesPerFrame)}process(e){const t=e[0],a=this.samplesPerFrame-this.samplesOffset;if(t.length>=a){this.samples.set(t.subarray(0,a),this.samplesOffset),this.sendMsg(s.AUDIO,this.samples);const e=t.subarray(a);e.length>=this.samplesPerFrame?(this.samplesOffset=0,this.process([e])):e.length>0?(this.samplesOffset=e.length,this.samples.set(e,0)):this.samplesOffset=0}else this.samples.set(t,this.samplesOffset),this.samplesOffset+=t.length}}if("function"==typeof registerProcessor){class a extends AudioWorkletProcessor{constructor(){super(),this.continueProcess=!0,this.port.onmessage=({data:a})=>{switch(a[0]){case e.START:this.implementation=new t(a[1],((...s)=>this.port.postMessage(s))),this.port.postMessage([s.STARTED,!0]);break;case e.STOP:this.continueProcess=!1,this.port.postMessage([s.STOPPED,void 0]);break;default:console.warn(`Unknown command ${a[0]}`)}}}process(s){return this.implementation&&s[0]&&s[0].length&&s[0][0]&&s[0][0].length&&this.implementation.process(s[0]),this.continueProcess}}registerProcessor("rustpotter-worklet",a)}else{let a;onmessage=({data:o})=>{switch(o[0]){case e.PROCESS:a&&a.process(o[1]);break;case e.STOP:a=null,postMessage([s.STOPPED,void 0]),close();break;case e.START:a=new t(o[1],((...s)=>postMessage(s))),postMessage([s.STARTED,!0]);break;default:console.warn(`Unknown command ${o[0]}`)}}}
